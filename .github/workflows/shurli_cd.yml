name: Shurli Linux CI

on:
  push:
    branches:
    - grewal
  # schedule:
    # Run at 00:00 UTC on Monday
    # - cron:  "0 0 * * 1"

jobs:

  linux-build:
    name: linux-build
    runs-on: ubuntu-latest

    steps:
      - name: Set up Go 1.14+
        uses: actions/setup-go@v2
        with:
          go-version: '^1.14.1' # The Go version to download (if necessary) and use.
      
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Build Shurli (Linux)
        env:
          DEBIAN_FRONTEND: noninteractive
        run: |
          mkdir -p $HOME/go/{bin,src,pkg} && \
          go get -u github.com/Meshbits/shurli && \
          cd $HOME/go/src/github.com/Meshbits/shurli && \
          make build-linux

      - name: Upload shurli-linux.zip as artifact
        uses: actions/upload-artifact@v1
        with:
          name: shurli-linux
          path: /home/runner/go/src/github.com/Meshbits/shurli/dist/shurli_linux.tar.gz
